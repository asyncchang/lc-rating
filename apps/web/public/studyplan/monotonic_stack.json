{
  "title": "分享丨【演算法題單】單調棧（矩形面積/貢獻法/最小字典序）",
  "src": "https://leetcode.cn/circle/discuss/9oZFK9/",
  "last_update": "2025-11-07T23:47:26.098808+00:00",
  "summary": "![單調棧題單](https://pic.leetcode.cn/1711714526-rMdiIh-t3-c.png)\n\n> *他向遠方望去，無法看到高山背後的矮山，只看到一座座更高的山峰*\n\n**前置知識**：建議先完成 [資料結構題單](https://leetcode.cn/circle/discuss/mOr1u6/) 中的「列舉右，維護左」及「棧」的基礎題\n\n**本題單涵蓋**：\n- 單調棧基礎：查詢左/右側更大/更小元素\n- 矩形面積：柱狀圖、最大矩形\n- 貢獻法：計算每個元素的貢獻\n- 最小字典序：構造問題",
  "children": [
    {
      "title": "一、單調棧",
      "summary": "",
      "children": [
        {
          "title": "§1.1 基礎",
          "summary": "**影片講解**：[單調棧【基礎演算法精講 26】](https://www.bilibili.com/video/BV1VN411J7S7/)\n\n**核心思想**：\n- 維護一個單調遞增/遞減的棧\n- 快速查詢每個元素左/右側第一個更大/更小的元素\n\n**模板程式碼**（查詢左/右側最近的更大元素）：見原文\n\n**時間複雜度**：O(n)",
          "isLeaf": true,
          "problems": [
            {
              "id": 739,
              "title": "739. 每日溫度",
              "slug": "/daily-temperatures/",
              "src": "https://leetcode.cn/problems/daily-temperatures/",
              "solution": null,
              "score": 1700,
              "isPremium": false
            },
            {
              "id": 1475,
              "title": "1475. 商品折扣後的最終價格",
              "slug": "/final-prices-with-a-special-discount-in-a-shop/",
              "src": "https://leetcode.cn/problems/final-prices-with-a-special-discount-in-a-shop/",
              "solution": null,
              "score": 1300,
              "isPremium": false
            },
            {
              "id": 496,
              "title": "496. 下一個更大元素 I",
              "slug": "/next-greater-element-i/",
              "src": "https://leetcode.cn/problems/next-greater-element-i/",
              "solution": null,
              "score": 1400,
              "isPremium": false
            },
            {
              "id": 503,
              "title": "503. 下一個更大元素 II",
              "slug": "/next-greater-element-ii/",
              "src": "https://leetcode.cn/problems/next-greater-element-ii/",
              "solution": null,
              "score": 1500,
              "isPremium": false
            },
            {
              "id": 901,
              "title": "901. 股票價格跨度",
              "slug": "/online-stock-span/",
              "src": "https://leetcode.cn/problems/online-stock-span/",
              "solution": null,
              "score": 1709,
              "isPremium": false
            },
            {
              "id": 853,
              "title": "853. 車隊",
              "slug": "/car-fleet/",
              "src": "https://leetcode.cn/problems/car-fleet/",
              "solution": null,
              "score": 1600,
              "isPremium": false
            }
          ]
        },
        {
          "title": "§1.2 進階（選做）",
          "summary": "**進階應用**（選做）\n\n**思維擴充套件題**：\n- [962. 最大寬度坡](https://leetcode.cn/problems/maximum-width-ramp/) (1608)\n- [3542. 將所有元素變為 0 的最少操作次數](https://leetcode.cn/problems/minimum-operations-to-convert-all-elements-to-zero/) (1890)\n- [1124. 表現良好的最長時間段](https://leetcode.cn/problems/longest-well-performing-interval/) (1908)",
          "isLeaf": true,
          "problems": [
            {
              "id": 1019,
              "title": "1019. 連結串列中的下一個更大節點",
              "slug": "/next-greater-node-in-linked-list/",
              "src": "https://leetcode.cn/problems/next-greater-node-in-linked-list/",
              "solution": null,
              "score": 1571,
              "isPremium": false
            },
            {
              "id": 768,
              "title": "768. 最多能完成排序的塊 II",
              "slug": "/max-chunks-to-make-sorted-ii/",
              "src": "https://leetcode.cn/problems/max-chunks-to-make-sorted-ii/",
              "solution": null,
              "score": 1788,
              "isPremium": false
            },
            {
              "id": 654,
              "title": "654. 最大二叉樹",
              "slug": "/maximum-binary-tree/",
              "src": "https://leetcode.cn/problems/maximum-binary-tree/",
              "solution": null,
              "score": 1600,
              "isPremium": false
            },
            {
              "id": 456,
              "title": "456. 132 模式",
              "slug": "/132-pattern/",
              "src": "https://leetcode.cn/problems/132-pattern/",
              "solution": null,
              "score": 2000,
              "isPremium": false
            },
            {
              "id": 3113,
              "title": "3113. 邊界元素是最大值的子陣列數目",
              "slug": "/find-the-number-of-subarrays-where-boundary-elements-are-maximum/",
              "src": "https://leetcode.cn/problems/find-the-number-of-subarrays-where-boundary-elements-are-maximum/",
              "solution": null,
              "score": 2046,
              "isPremium": false
            },
            {
              "id": 2866,
              "title": "2866. 美麗塔 II",
              "slug": "/beautiful-towers-ii/",
              "src": "https://leetcode.cn/problems/beautiful-towers-ii/",
              "solution": null,
              "score": 2072,
              "isPremium": false
            },
            {
              "id": 1944,
              "title": "1944. 佇列中可以看到的人數",
              "slug": "/number-of-visible-people-in-a-queue/",
              "src": "https://leetcode.cn/problems/number-of-visible-people-in-a-queue/",
              "solution": null,
              "score": 2105,
              "isPremium": false
            },
            {
              "id": 2454,
              "title": "2454. 下一個更大元素 IV",
              "slug": "/next-greater-element-iv/",
              "src": "https://leetcode.cn/problems/next-greater-element-iv/",
              "solution": null,
              "score": 2175,
              "isPremium": false
            },
            {
              "id": 1130,
              "title": "1130. 葉值的最小代價生成樹",
              "slug": "/minimum-cost-tree-from-leaf-values/",
              "src": "https://leetcode.cn/problems/minimum-cost-tree-from-leaf-values/",
              "solution": null,
              "score": 1800,
              "isPremium": false
            },
            {
              "id": 2289,
              "title": "2289. 使陣列按非遞減順序排列",
              "slug": "/steps-to-make-array-non-decreasing/",
              "src": "https://leetcode.cn/problems/steps-to-make-array-non-decreasing/",
              "solution": null,
              "score": 2482,
              "isPremium": false
            },
            {
              "id": 1776,
              "title": "1776. 車隊 II",
              "slug": "/car-fleet-ii/",
              "src": "https://leetcode.cn/problems/car-fleet-ii/",
              "solution": null,
              "score": 2531,
              "isPremium": false
            },
            {
              "id": 2736,
              "title": "2736. 最大和查詢",
              "slug": "/maximum-sum-queries/",
              "src": "https://leetcode.cn/problems/maximum-sum-queries/",
              "solution": null,
              "score": 2533,
              "isPremium": false
            },
            {
              "id": 3420,
              "title": "3420. 統計 K 次操作以內得到非遞減子陣列的數目",
              "slug": "/count-non-decreasing-subarrays-after-k-operations/",
              "src": "https://leetcode.cn/problems/count-non-decreasing-subarrays-after-k-operations/",
              "solution": null,
              "score": 2855,
              "isPremium": true
            },
            {
              "id": 3221,
              "title": "3221. 最大陣列跳躍得分 II",
              "slug": "/maximum-array-hopping-score-ii/",
              "src": "https://leetcode.cn/problems/maximum-array-hopping-score-ii/",
              "solution": null,
              "score": 2700,
              "isPremium": true
            },
            {
              "id": 1966,
              "title": "1966. 未排序陣列中的可被二分搜尋的數",
              "slug": "/binary-searchable-numbers-in-an-unsorted-array/",
              "src": "https://leetcode.cn/problems/binary-searchable-numbers-in-an-unsorted-array/",
              "solution": null,
              "score": 2300,
              "isPremium": true
            },
            {
              "id": 2832,
              "title": "2832. 每個元素為最大值的最大範圍",
              "slug": "/maximal-range-that-each-element-is-maximum-in-it/",
              "src": "https://leetcode.cn/problems/maximal-range-that-each-element-is-maximum-in-it/",
              "solution": null,
              "score": 2600,
              "isPremium": true
            },
            {
              "id": 2282,
              "title": "2282. 在一個網格中可以看到的人數",
              "slug": "/number-of-people-that-can-be-seen-in-a-grid/",
              "src": "https://leetcode.cn/problems/number-of-people-that-can-be-seen-in-a-grid/",
              "solution": null,
              "score": 2500,
              "isPremium": true
            },
            {
              "id": 3555,
              "title": "3555. 排序每個滑動視窗中最小的子陣列",
              "slug": "/smallest-subarray-to-sort-in-every-sliding-window/",
              "src": "https://leetcode.cn/problems/smallest-subarray-to-sort-in-every-sliding-window/",
              "solution": null,
              "score": 2750,
              "isPremium": true
            }
          ]
        }
      ],
      "isLeaf": false
    },
    {
      "title": "二、矩形",
      "summary": "",
      "children": [
        {
          "title": "二、矩形",
          "summary": "",
          "isLeafParent": true,
          "problems": [
            {
              "id": 84,
              "title": "84. 柱狀圖中最大的矩形",
              "slug": "/largest-rectangle-in-histogram/",
              "src": "https://leetcode.cn/problems/largest-rectangle-in-histogram/",
              "solution": null,
              "score": 1900,
              "isPremium": false
            },
            {
              "id": 1793,
              "title": "1793. 好子陣列的最大分數",
              "slug": "/maximum-score-of-a-good-subarray/",
              "src": "https://leetcode.cn/problems/maximum-score-of-a-good-subarray/",
              "solution": null,
              "score": 1946,
              "isPremium": false
            },
            {
              "id": 85,
              "title": "85. 最大矩形",
              "slug": "/maximal-rectangle/",
              "src": "https://leetcode.cn/problems/maximal-rectangle/",
              "solution": null,
              "score": 2100,
              "isPremium": false
            },
            {
              "id": 221,
              "title": "221. 最大正方形",
              "slug": "/maximal-square/",
              "src": "https://leetcode.cn/problems/maximal-square/",
              "solution": null,
              "score": 1800,
              "isPremium": false
            },
            {
              "id": 42,
              "title": "42. 接雨水",
              "slug": "/trapping-rain-water/",
              "src": "https://leetcode.cn/problems/trapping-rain-water/",
              "solution": null,
              "score": 1950,
              "isPremium": false
            },
            {
              "id": 1504,
              "title": "1504. 統計全 1 子矩形",
              "slug": "/count-submatrices-with-all-ones/",
              "src": "https://leetcode.cn/problems/count-submatrices-with-all-ones/",
              "solution": null,
              "score": 1700,
              "isPremium": false
            },
            {
              "id": 1277,
              "title": "1277. 統計全為 1 的正方形子矩陣",
              "slug": "/count-square-submatrices-with-all-ones/",
              "src": "https://leetcode.cn/problems/count-square-submatrices-with-all-ones/",
              "solution": null,
              "score": 1600,
              "isPremium": false
            },
            {
              "id": 755,
              "title": "755. 倒水",
              "slug": "/pour-water/",
              "src": "https://leetcode.cn/problems/pour-water/",
              "solution": null,
              "score": 2100,
              "isPremium": true
            }
          ],
          "isLeaf": true
        }
      ],
      "isLeaf": false
    },
    {
      "title": "三、貢獻法",
      "summary": "**核心技巧**：計算每個元素作為最小值/最大值時對答案的貢獻\n\n**思維擴充套件題**：\n- [2334. 元素值大於變化閾值的子陣列](https://leetcode.cn/problems/subarray-with-elements-greater-than-varying-threshold/) (2381)\n- [2962. 統計最大元素出現至少 K 次的子陣列](https://leetcode.cn/problems/count-subarrays-where-max-element-appears-at-least-k-times/solutions/2560940/) 思考題",
      "children": [
        {
          "title": "",
          "summary": "",
          "isLeafParent": true,
          "problems": [
            {
              "id": 907,
              "title": "907. 子陣列的最小值之和",
              "slug": "/sum-of-subarray-minimums/",
              "src": "https://leetcode.cn/problems/sum-of-subarray-minimums/",
              "solution": null,
              "score": 1976,
              "isPremium": false
            },
            {
              "id": 2104,
              "title": "2104. 子陣列範圍和（最大值-最小值）",
              "slug": "/sum-of-subarray-ranges/",
              "src": "https://leetcode.cn/problems/sum-of-subarray-ranges/",
              "solution": null,
              "score": 2000,
              "isPremium": false
            },
            {
              "id": 1856,
              "title": "1856. 子陣列最小乘積的最大值",
              "slug": "/maximum-subarray-min-product/",
              "src": "https://leetcode.cn/problems/maximum-subarray-min-product/",
              "solution": null,
              "score": 2051,
              "isPremium": false
            },
            {
              "id": 2818,
              "title": "2818. 操作使得分最大",
              "slug": "/apply-operations-to-maximize-score/",
              "src": "https://leetcode.cn/problems/apply-operations-to-maximize-score/",
              "solution": null,
              "score": 2397,
              "isPremium": false
            },
            {
              "id": 2281,
              "title": "2281. 巫師的總力量和（最小值×和）",
              "slug": "/sum-of-total-strength-of-wizards/",
              "src": "https://leetcode.cn/problems/sum-of-total-strength-of-wizards/",
              "solution": null,
              "score": 2621,
              "isPremium": false
            },
            {
              "id": 3430,
              "title": "3430. 最多 K 個元素的子陣列的最值之和",
              "slug": "/maximum-and-minimum-sums-of-at-most-size-k-subarrays/",
              "src": "https://leetcode.cn/problems/maximum-and-minimum-sums-of-at-most-size-k-subarrays/",
              "solution": null,
              "score": 2645,
              "isPremium": false
            },
            {
              "id": 3359,
              "title": "3359. 查詢最大元素不超過 K 的有序子矩陣",
              "slug": "/find-sorted-submatrices-with-maximum-element-at-most-k/",
              "src": "https://leetcode.cn/problems/find-sorted-submatrices-with-maximum-element-at-most-k/",
              "solution": null,
              "score": 2700,
              "isPremium": true
            }
          ],
          "isLeaf": true
        }
      ],
      "isLeaf": false
    },
    {
      "title": "四、最小字典序",
      "summary": "",
      "problems": [
        {
          "id": 402,
          "title": "402. 移掉 K 位數字",
          "slug": "/remove-k-digits/",
          "src": "https://leetcode.cn/problems/remove-k-digits/",
          "solution": null,
          "score": 1800,
          "isPremium": false
        },
        {
          "id": 1673,
          "title": "1673. 找出最具競爭力的子序列",
          "slug": "/find-the-most-competitive-subsequence/",
          "src": "https://leetcode.cn/problems/find-the-most-competitive-subsequence/",
          "solution": null,
          "score": 1802,
          "isPremium": false
        },
        {
          "id": 316,
          "title": "316. 去除重複字母",
          "slug": "/remove-duplicate-letters/",
          "src": "https://leetcode.cn/problems/remove-duplicate-letters/",
          "solution": null,
          "score": 2185,
          "isPremium": false
        },
        {
          "id": 1081,
          "title": "1081. 不同字元的最小子序列",
          "slug": "/smallest-subsequence-of-distinct-characters/",
          "src": "https://leetcode.cn/problems/smallest-subsequence-of-distinct-characters/",
          "solution": null,
          "score": 2185,
          "isPremium": false
        },
        {
          "id": 321,
          "title": "321. 拼接最大數",
          "slug": "/create-maximum-number/",
          "src": "https://leetcode.cn/problems/create-maximum-number/",
          "solution": null,
          "score": 2300,
          "isPremium": false
        },
        {
          "id": 2030,
          "title": "2030. 含特定字母的最小子序列",
          "slug": "/smallest-k-length-subsequence-with-occurrences-of-a-letter/",
          "src": "https://leetcode.cn/problems/smallest-k-length-subsequence-with-occurrences-of-a-letter/",
          "solution": null,
          "score": 2562,
          "isPremium": false
        }
      ],
      "isLeaf": true
    },
    {
      "title": "關聯題單",
      "summary": "<ul><li><strong>單調棧最佳化 DP</strong>：見 <a href=\"https://leetcode.cn/circle/discuss/tXLS3i/\">動態規劃題單</a> 中的「§11.2 單調棧最佳化 DP」。</li><li><strong>單調佇列</strong>：見 <a href=\"https://leetcode.cn/circle/discuss/mOr1u6/\">資料結構題單</a> 中的「§4.3 單調佇列」。</li></ul><br><a href=\"https://leetcode.cn/circle/discuss/RvFUtj/\">如何科學刷題？</a><br><ol><li><a href=\"https://leetcode.cn/circle/discuss/0viNMK/\">滑動視窗與雙指標（定長/不定長/單序列/雙序列/三指標/分組迴圈）</a></li><li><a href=\"https://leetcode.cn/circle/discuss/SqopEo/\">二分演算法（二分答案/最小化最大值/最大化最小值/第K小）</a></li><li><a href=\"https://leetcode.cn/circle/discuss/9oZFK9/\">單調棧（基礎/矩形面積/貢獻法/最小字典序）</a></li><li><a href=\"https://leetcode.cn/circle/discuss/YiXPXW/\">網格圖（DFS/BFS/綜合應用）</a></li><li><a href=\"https://leetcode.cn/circle/discuss/dHn9Vk/\">位運算（基礎/性質/拆位/試填/恆等式/思維）</a></li><li><a href=\"https://leetcode.cn/circle/discuss/01LUak/\">圖論演算法（DFS/BFS/拓撲排序/基環樹/最短路/最小生成樹/網路流）</a></li><li><a href=\"https://leetcode.cn/circle/discuss/tXLS3i/\">動態規劃（入門/背包/劃分/狀態機/區間/狀壓/數位/資料結構最佳化/樹形/博弈/機率期望）</a></li><li><a href=\"https://leetcode.cn/circle/discuss/mOr1u6/\">常用資料結構（字首和/差分/棧/佇列/堆/字典樹/並查集/樹狀陣列/線段樹）</a></li><li><a href=\"https://leetcode.cn/circle/discuss/IYT3ss/\">數學演算法（數論/組合/機率期望/博弈/計算幾何/隨機演算法）</a></li><li><a href=\"https://leetcode.cn/circle/discuss/g6KTKL/\">貪心與思維（基本貪心策略/反悔/區間/字典序/數學/思維/腦筋急轉彎/構造）</a></li><li><a href=\"https://leetcode.cn/circle/discuss/K0n2gO/\">連結串列、二叉樹與回溯（前後指標/快慢指標/DFS/BFS/直徑/LCA/一般樹）</a></li><li><a href=\"https://leetcode.cn/circle/discuss/SJFwQI/\">字串（KMP/Z函式/Manacher/字串雜湊/AC自動機/字尾陣列/子序列自動機）</a></li></ol><br><a href=\"https://github.com/EndlessCheng/codeforces-go/blob/master/leetcode/SOLUTIONS.md\">我的題解精選（已分類）</a><br><br>歡迎關注 <a href=\"https://space.bilibili.com/206214\">B站@靈茶山艾府</a><br><br>如果你發現有題目可以補充進來，歡迎評論反饋。",
      "isLeaf": true
    }
  ]
}